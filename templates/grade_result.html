<h2>{{ student.nickname }}님의 성적표</h2>
<p>시험: {{ exam.title }}</p>
<p>점수: {{ result.score }}</p>

<style>
  .result-question { margin-bottom: 32px; }
  .result-title { font-size: 1.1em; margin-bottom: 10px; font-weight: bold; }
  .result-choices { display: flex; justify-content: space-between; gap: 10px; margin-bottom: 8px; }
  .result-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #e9ecef;
    border-radius: 8px;
    padding: 16px 0;
    font-size: 1.1em;
    border: 2px solid transparent;
    color: #333;
    font-weight: bold;
    position: relative;
    transition: background 0.2s, border 0.2s;
    margin: 0 2px;
  }
  .result-btn.selected { background: #007bff; color: #fff; border: 2px solid #0056b3; }
  .result-btn.correct { border: 2px solid #28a745; box-shadow: 0 0 0 2px #28a74544; }
  .result-btn.wrong.selected { background: #dc3545; color: #fff; border: 2px solid #dc3545; }
  .result-btn .icon {
    position: absolute; top: 6px; right: 8px; font-size: 1.2em;
  }
  .result-feedback {
    text-align: left; margin-top: 4px; font-size: 1em; font-weight: bold;
  }
  @media (max-width: 600px) {
    .result-choices { gap: 4px; }
    .result-btn { font-size: 1em; padding: 12px 0; }
  }
</style>

<div style="max-width:500px;margin:30px auto 0 auto;">
  {% for q in question_results %}
    <div class="result-question">
      <div class="result-title">문항 {{ q.number }}</div>
      <div class="result-choices">
        {% for i in range(1,6) %}
          {% set is_selected = (q.student_answer == i) %}
          {% set is_correct = (q.correct_answer == i) %}
          <div class="result-btn
            {% if is_selected and q.is_correct %} selected correct
            {% elif is_selected and not q.is_correct %} selected wrong
            {% elif is_correct %} correct
            {% endif %}">
            {{ i }}
            {% if is_selected and q.is_correct %}<span class="icon" style="color:#28a745;">⭕</span>{% endif %}
            {% if is_selected and not q.is_correct %}<span class="icon" style="color:#dc3545;">✗</span>{% endif %}
            {% if is_correct and not is_selected %}<span class="icon" style="color:#b2e59e;">⭕</span>{% endif %}
          </div>
        {% endfor %}
      </div>
      <div class="result-feedback" style="color:{{ 'green' if q.is_correct else 'red' }};">
        {{ '정답' if q.is_correct else '오답 (내 답: ' ~ (q.student_answer if q.student_answer else '-') ~ ', 정답: ' ~ q.correct_answer ~ ')'}}
      </div>
    </div>
  {% endfor %}
</div>